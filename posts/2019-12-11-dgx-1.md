---

feed:
  enable: true
  title: How to play with DGX-1
  description: How to play with DGX-1
  image: /images/dgx1.png
  date: 2019-12-11
  author:
    -
      name: Alex Shvid
      email: alex@shvid.com
      link: https://www.alexshvid.com
---

![](/images/dgx1.png)

# How to play with DGX-1

I have a new toy, this is a DGX-1 box that I am going to use today.
It does not connect have connection to internet, therefore I have some challenges to run software on it.

I have no admin right on it, therefore I can run only docker containers or some manually written programs if I need.

Let's start from detecting the version of the DGX-1 and GPU cards that is has

After running

```
nvidia-smi
```

I got this output

```
Wed Dec 11 13:14:55 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 384.145                Driver Version: 384.145                   |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla V100-SXM2...  On   | 00000000:06:00.0 Off |                    0 |
| N/A   38C    P0    44W / 300W |     10MiB / 32502MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla V100-SXM2...  On   | 00000000:07:00.0 Off |                    0 |
| N/A   39C    P0    43W / 300W |     10MiB / 32502MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   2  Tesla V100-SXM2...  On   | 00000000:0A:00.0 Off |                    0 |
| N/A   39C    P0    42W / 300W |     10MiB / 32502MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   3  Tesla V100-SXM2...  On   | 00000000:0B:00.0 Off |                    0 |
| N/A   38C    P0    43W / 300W |     10MiB / 32502MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   4  Tesla V100-SXM2...  On   | 00000000:85:00.0 Off |                    0 |
| N/A   40C    P0    40W / 300W |     10MiB / 32502MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   5  Tesla V100-SXM2...  On   | 00000000:86:00.0 Off |                    0 |
| N/A   40C    P0    45W / 300W |     10MiB / 32502MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   6  Tesla V100-SXM2...  On   | 00000000:89:00.0 Off |                    0 |
| N/A   43C    P0    45W / 300W |     10MiB / 32502MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   7  Tesla V100-SXM2...  On   | 00000000:8A:00.0 Off |                    0 |
| N/A   40C    P0    47W / 300W |     10MiB / 32502MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
```

It loos like the installed version of Nvidia drivers is 384.145, that corresponds to CUDA version 9.0 through this table:

```
CUDA 10.2 (10.2.89) 	>= 440.33
CUDA 10.1 (10.1.105) 	>= 418.39
CUDA 10.0 (10.0.130) 	>= 410.48
CUDA 9.2 (9.2.88) 	>= 396.26
CUDA 9.1 (9.1.85) 	>= 390.46
CUDA 9.0 (9.0.76) 	>= 384.81
CUDA 8.0 (8.0.61 GA2) 	>= 375.26
CUDA 8.0 (8.0.44) 	>= 367.48
CUDA 7.5 (7.5.16) 	>= 352.31
CUDA 7.0 (7.0.28) 	>= 346.46
```

So, that is good, we know the version and we can try to run docker container:

```
docker run --runtime nvidia nvidia/cuda:9.0-base nvidia-smi
```

I am getting this error:

```
Unable to find image 'nvidia/cuda:9.0-base' locally
docker: Error response from daemon: Get https://registry-1.docker.io/v2/: dial tcp XX.XX.XX.XX:443: getsockopt: connection refused.
See 'docker run --help'.
```

The box is not connected to internet, therefore I need to download image on another machine, dump it, copy and load to DGX-1.

After running the same command in another machine, image was downloaded and stored.

```
docker image ls
REPOSITORY                                 TAG                      IMAGE ID            CREATED             SIZE
nvidia/cuda                                9.0-base                 3c57055e68a2        2 weeks ago         140MB
```

Now, we are ready to dump the image and compress on the fly

```
docker save nvidia/cuda:9.0-base | gzip > nvidia_cuda_9_0_base.tar.gz
```

Here it is
```
50269763 Dec 11 14:00 nvidia_cuda_9_0_base.tar.gz
```

This image is ready to upload to DGX-1 machine.


